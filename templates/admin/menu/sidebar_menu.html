{% load i18n static %}


<nav class="sidebar" id="sidebar">
    <!-- Toggle Button -->
    <div class="sidebar-toggle" onclick="toggleSidebar()">
        <span class="toggle-icon">â˜°</span>
    </div>
    
    <div class="sidebar-header">
        <h3>
            <span class="sidebar-icon">ğŸ </span>
            <span class="sidebar-text">Dashboard</span>
        </h3>
    </div>
    
    <ul class="nav-menu">
        <li class="nav-item">
            <a href="/welcome/" class="nav-link {% if request.resolver_match.url_name == 'welcome' %}active{% endif %}">
                <span class="nav-icon">ğŸ </span>
                <span class="nav-text">Inicio</span>
            </a>
        </li>
        
        <!-- GestiÃ³n de Empresas, Proyectos - Desplegable -->
        <li class="nav-item has-submenu">
            <a href="{% url 'empresas:dashboard' %}" class="nav-link" onclick="toggleSubmenu(this)">
                <span class="nav-icon">ğŸ¢</span>
                <span class="nav-text">Empresas</span>
                <span class="submenu-arrow">â–¼</span>
            </a>
            <div id="empresas-submenu" class="submenu">
                <a href="{% url 'empresas:empresas_list' %}" class="submenu-link">
                    <span class="submenu-icon">ğŸ“‹</span>
                    Lista de Empresas
                </a>
                <a href="{% url 'empresas:empresa_create' %}" class="submenu-link">
                    <span class="submenu-icon">â•</span>
                    Nueva Empresa
                </a>
                
                <!-- Comentar temporalmente hasta que funcionen -->
                <!--
                <a href="{% url 'empresas:proyectos_list' %}" class="submenu-link">
                    <span class="submenu-icon">ğŸ“</span>
                    Proyectos
                </a>
                <a href="{% url 'empresas:centros_operativos_list' %}" class="submenu-link">
                    <span class="submenu-icon">ğŸ­</span>
                    Centros Operativos
                </a>
                -->
            </div>
        </li>
        
        <!-- GestiÃ³n de Usuarios - Desplegable -->
        <li class="nav-item has-submenu">
            <a href="#" class="nav-link" onclick="toggleSubmenu(this)">
                <span class="nav-icon">ğŸ‘¥</span>
                <span class="nav-text">Usuarios</span>
                <span class="submenu-arrow">â–¼</span>
            </a>
            <ul class="submenu">
                <li><a href="/admin/auth/user/" class="submenu-link">Lista de Usuarios</a></li>
                <li><a href="/admin/auth/user/add/" class="submenu-link">Nuevo Usuario</a></li>
                <li><a href="/admin/auth/group/" class="submenu-link">Grupos</a></li>
                <li><a href="/admin/auth/permission/" class="submenu-link">Permisos</a></li>
            </ul>
        </li>
        
        <!-- GestiÃ³n de Turnos - Desplegable -->
        <li class="nav-item has-submenu">
            <a href="#" class="nav-link" onclick="toggleSubmenu(this)">
                <span class="nav-icon">â°</span>
                <span class="nav-text">Turnos</span>
                <span class="submenu-arrow">â–¼</span>
            </a>
            <ul class="submenu">
                <li><a href="/admin/turnos/modeloturno/" class="submenu-link">Modelos de Turno</a></li>
                <li><a href="/admin/turnos/programacion/" class="submenu-link">Programaciones</a></li>
                <li><a href="/admin/turnos/asignacion/" class="submenu-link">Asignaciones</a></li>
            </ul>
        </li>
        
        <li class="nav-item">
            <a href="/admin/" class="nav-link">
                <span class="nav-icon">ğŸ“Š</span>
                <span class="nav-text">Panel Admin</span>
            </a>
        </li>
        
        <li class="nav-item">
            <a href="/admin/" class="nav-link">
                <span class="nav-icon">ğŸ“‹</span>
                <span class="nav-text">Reportes</span>
            </a>
        </li>
        
        <li class="nav-item">
            <a href="/admin/" class="nav-link">
                <span class="nav-icon">âš™ï¸</span>
                <span class="nav-text">ConfiguraciÃ³n</span>
            </a>
        </li>
    </ul>
</nav>

<script>
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('collapsed');
    
    // Guardar estado en localStorage
    const isCollapsed = sidebar.classList.contains('collapsed');
    localStorage.setItem('sidebarCollapsed', isCollapsed);
}

function toggleSubmenu(element) {
    const submenu = element.nextElementSibling;
    const arrow = element.querySelector('.submenu-arrow');
    const isOpen = submenu.style.display === 'block';
    
    // Cerrar todos los otros submenÃºs
    document.querySelectorAll('.submenu').forEach(sm => {
        if (sm !== submenu) {
            sm.style.display = 'none';
            sm.parentElement.querySelector('.submenu-arrow').innerHTML = 'â–¼';
        }
    });
    
    // Toggle actual submenu
    if (isOpen) {
        submenu.style.display = 'none';
        arrow.innerHTML = 'â–¼';
    } else {
        submenu.style.display = 'block';
        arrow.innerHTML = 'â–²';
    }
}

// Restaurar estado del sidebar al cargar
document.addEventListener('DOMContentLoaded', function() {
    const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    if (isCollapsed) {
        document.getElementById('sidebar').classList.add('collapsed');
    }
});
</script>